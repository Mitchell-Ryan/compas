<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Config files | Compas</title>
    <meta name="description" content="Unified backend tooling">
    <link rel="stylesheet" href="/assets/style.c3210e46.css">
    <link rel="modulepreload" href="/assets/app.cf930e1c.js">
    <link rel="modulepreload" href="/assets/features_config-files.md.0f11a587.lean.js">
    
    <meta name="twitter:title" content="Config files | Compas">
  <meta property="og:title" content="Config files | Compas">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Compas, back to home" data-v-675d8756 data-v-cc01ef16><!----> Compas</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/getting-started.html" data-v-b8818f8c>Docs <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/examples.html" data-v-b8818f8c>Examples <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog" data-v-b8818f8c>Changelog <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/releases/index.html" data-v-b8818f8c>Release notes <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/compasjs/compas" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/getting-started.html" data-v-b8818f8c>Docs <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/examples.html" data-v-b8818f8c>Examples <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog" data-v-b8818f8c>Changelog <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/releases/index.html" data-v-b8818f8c>Release notes <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/compasjs/compas" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/getting-started.html">Getting started</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">Features</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/features/cli.html">CLI</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/lint-setup.html">Linting and formatting</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/typescript-setup.html">Typescript setup</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/logger-and-events.html">Logger &amp; events</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/features/config-files.html">Configuration files</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#environment-variables">Environment variables</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#config-loader">Config loader</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/test-and-bench-runner.html">Testing and benchmarking</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/http-server.html">HTTP server</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/postgres-and-minio.html">Postgres and Minio</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/code-gen-validators.html">Code generation</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/code-gen-api.html">Code generation API</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/code-gen-api-client.html">Code generation API client</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/code-gen-sql.html">Code generation SQL queries</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/code-gen-crud.html">Code generation CRUD</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/migrations.html">Postgres migrations</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/background-jobs.html">Background jobs</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/session-handling.html">Session handling</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/file-handling.html">File handling</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/extending-the-cli.html">Extending the CLI</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/features/route-invalidations.html">Route invalidations</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/examples.html">Examples</a><!----></li><li class="sidebar-link"><p class="sidebar-link-item">References</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/references/compas-config.html">Compas configuration</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/references/cli.html">CLI Reference</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/migrations/index.html">Migrations</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/migrations/store.html">@compas/store</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="config-files" tabindex="-1">Config files <a class="header-anchor" href="#config-files" aria-hidden="true">#</a></h1><h2 id="environment-variables" tabindex="-1">Environment variables <a class="header-anchor" href="#environment-variables" aria-hidden="true">#</a></h2><p>Compas lets you forget loading your <code>.env</code> files. All main entry points (<code>mainFn</code>, <code>mainTestFn</code> and <code>mainBenchFn</code>) will load both the <code>.env</code> and <code>.env.local</code> files automatically. The loader that is used is provided by the <a href="https://www.npmjs.com/package/dotenv" target="_blank" rel="noopener noreferrer">dotenv</a> package.</p><p>Compas advises to check in a ready to go <code>.env.example</code> in your version control or preferably when using all Compas provided tooling, just a <code>.env</code> file without any actual production secrets. This way new contributors can just fire up some commands and verify that they can run your project locally instead of trying to figure out what they need to configure where.</p><p>The <code>.env</code> file loader skips keys already present in your environment. This is also used by the <code>.env.local</code> file. It is loaded first so any environment variables present in both <code>.env.local</code> and <code>.env</code> will have the value defined by the former.</p><p>To speed up accessing environment variables the @compas/stdlib package provides an exported object <code>environment</code> which is an exact copy of <code>process.<wbr>env</code> before the callback is called in <code>mainFn</code>. If you use <code>process.<wbr>env</code> to set values, please don&#39;t, you can use <code>refreshEnvironmentCache</code> to make a new copy.</p><div class="danger custom-block"><p class="custom-block-title">WARNING</p><p>Never check in production secrets in to your version control.</p></div><h2 id="config-loader" tabindex="-1">Config loader <a class="header-anchor" href="#config-loader" aria-hidden="true">#</a></h2><p>Compas also comes with a configuration file loader in <code>@compas/stdlib</code>. This will be used by other Compas features, but also allows you to have a project specific configuration file. You can use this to validate and convert your environment variables for example doing the following transformation:</p><div class="language-.dotenv"><pre><code>POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
</code></pre></div><p>to</p><div class="language-js"><pre><code><span class="token comment">// config/my-project.js</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">postgres</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">user</span><span class="token operator">:</span> environment<span class="token punctuation">.</span><span class="token constant">POSTGRES_USER</span><span class="token punctuation">,</span>
      <span class="token literal-property property">password</span><span class="token operator">:</span> environment<span class="token punctuation">.</span><span class="token constant">POSTGRES_PASSWORD</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Or it can be used by for example Compas to let you specify your migrations directory to make <code>compas migrate</code> more configurable.</p><p>The configuration files can be in 2 formats: JSON or ES modules (both <code>.js</code> and <code>.mjs</code> extensions are supported). The ES module should export a synchronous function returning a config data object. The configuration files can be loaded from the project root, the project <code>config</code> directory, or from the OS and user specific config directory.</p><p><strong>configLoaderGet()</strong></p><p>The config file load function, it caches results based on the provided name and key. It returns promise resolving to an object with the following properties:</p><div class="language-js"><pre><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">configLoaderGet</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;example&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">location</span><span class="token operator">:</span> <span class="token string">&quot;project&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// always equals to the provided name, &#39;example&#39;</span>
result<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token comment">// always equal to the provided location, &#39;project&#39;</span>
result<span class="token punctuation">.</span>location<span class="token punctuation">;</span>

<span class="token comment">// object, does not exist if no config file is found</span>
result<span class="token punctuation">.</span>resolvedLocation<span class="token punctuation">;</span>
<span class="token comment">// The directory where the config file is found</span>
result<span class="token punctuation">.</span>resolvedLocation<span class="token punctuation">.</span>directory<span class="token punctuation">;</span>
<span class="token comment">// Filename with extension, `example.json` or `example.js` or `example.mjs`</span>
result<span class="token punctuation">.</span>resolvedLocation<span class="token punctuation">.</span>filename<span class="token punctuation">;</span>

<span class="token comment">// Object, either the object returned from a config function or a parsed json file.</span>
<span class="token comment">// This is an empty object if no config file is found</span>
result<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
</code></pre></div><p><strong>configLoaderDeleteCache</strong></p><p>Delete the config loader cache. This can be used if your tool overwrites the config, or when writing some reload / watch behaviour.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><a class="link" href="https://github.com/compasjs/compas/edit/main/docs/features/config-files.md" target="_blank" rel="noopener noreferrer" data-v-1ed99556>Edit this page on GitHub <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-1ed99556><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/features/logger-and-events" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Logger &amp; events</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/features/test-and-bench-runner" data-v-38ede35f><span class="text" data-v-38ede35f>Testing and benchmarking</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"changelog.md\":\"a051c557\",\"contributing.md\":\"9bfce678\",\"examples.md\":\"20a7d50d\",\"features_background-jobs.md\":\"37d26688\",\"features_cli.md\":\"da0bbfcf\",\"features_code-gen-api-client.md\":\"4198e896\",\"features_code-gen-api.md\":\"5566d552\",\"features_code-gen-crud.md\":\"ef8194cf\",\"features_code-gen-sql.md\":\"c8c939a1\",\"features_code-gen-validators.md\":\"199472e2\",\"features_config-files.md\":\"0f11a587\",\"features_extending-the-cli.md\":\"6c205d8e\",\"features_file-handling.md\":\"8e8a72df\",\"features_http-server.md\":\"f0b10171\",\"features_lint-setup.md\":\"0e7b41d2\",\"features_logger-and-events.md\":\"9b76c254\",\"features_migrations.md\":\"233899ca\",\"features_postgres-and-minio.md\":\"507a97c4\",\"features_route-invalidations.md\":\"0e15fb4e\",\"features_session-handling.md\":\"098b3081\",\"features_test-and-bench-runner.md\":\"de3d5eee\",\"features_typescript-setup.md\":\"bae7af0c\",\"getting-started.md\":\"b88cae49\",\"index.md\":\"e7192c6b\",\"migrations_index.md\":\"83f1951e\",\"migrations_store.md\":\"6cddb0dd\",\"references_cli.md\":\"48cda47c\",\"references_compas-config.md\":\"fcd50741\",\"releases_0.0.103.md\":\"ffffe48f\",\"releases_0.0.115.md\":\"82be64cd\",\"releases_0.0.119.md\":\"857e335c\",\"releases_0.0.124.md\":\"64749ebb\",\"releases_0.0.138.md\":\"387d8339\",\"releases_0.0.158.md\":\"c5ef0701\",\"releases_0.0.171.md\":\"29980ce0\",\"releases_0.0.172.md\":\"f5893116\",\"releases_0.0.180.md\":\"4f4d6bea\",\"releases_0.0.79.md\":\"81bb756d\",\"releases_0.0.81.md\":\"f0c81d75\",\"releases_0.0.83.md\":\"9893b66f\",\"releases_0.0.84.md\":\"80f2a6ce\",\"releases_0.0.89.md\":\"389c7324\",\"releases_index.md\":\"d46c73ba\"}")</script>
    <script type="module" async src="/assets/app.cf930e1c.js"></script>
    
  </body>
</html>