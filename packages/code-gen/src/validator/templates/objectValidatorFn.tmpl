{{ for (const key of Object.keys(keys)) { }}
{{= validatorsAnonFn(keys[key]) }}
{{ } }}

const {{= functionName }} = (value, propertyPath) => {
  if (isNil(value)) {
    {{ if (it.optional) { }}
      return undefined;
    {{ } else { }}
      throw AppError.validationError("validator.object.undefined", { propertyPath });
    {{ } }}
  }

  if (typeof value !== "object") {
    throw AppError.validationError("validator.object.type", { propertyPath });
  }
  const result = {};

  {{ if (it.strict) { }}
  const keySet = new Set(Object.keys(value));
  {{ } }}

  {{ for (const key of Object.keys(keys)) { }}
    result[{{= quote(key) }}] = {{= keys[key].functionName }}(value[{{= quote(key) }}], propertyPath + "." + {{= quote(key) }});

    {{ if (it.strict) { }}
    keySet.delete({{= quote(key) }});
    {{ } }}
  {{ } }}

  {{ if (it.strict) { }}
  if (keySet.size !== 0) {
    let extraKeys = "";
    for (const k of keySet.keys()) { extraKeys += k + ","; }
    throw AppError.validationError("validator.object.strict", { propertyPath, extraKeys });
  }
  {{ } }}

  return result;
};
