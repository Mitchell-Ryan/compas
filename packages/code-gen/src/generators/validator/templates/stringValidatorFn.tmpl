{{ if (model.validator.convert) { }}
  if (typeof value !== "string") {
    value = String(value)
  }
{{ } }}

if (typeof value !== "string") {
  throw _errorFn("validator.string.type", { propertyPath });
}

{{ if (model.validator.trim) { }}
  value = value.trim();
{{ } }}

{{ if (model.validator.min !== undefined) { }}
  if (value.length < {{= model.validator.min }}) {
    const min = {{= model.validator.min }};
    throw _errorFn("validator.string.min", { propertyPath, min });
  }
{{ } }}

{{ if (model.validator.max !== undefined) { }}
  if (value.length > {{= model.validator.max }}) {
    const max = {{= model.validator.max }};
    throw _errorFn("validator.string.max", { propertyPath, max });
  }
{{ } }}

{{ if (model.validator.upperCase) { }}
  value = value.toUpperCase();
{{ } }}

{{ if (model.validator.lowerCase) { }}
  value = value.toLowerCase();
{{ } }}

{{ if (model.oneOf !== undefined) { }}
  if ({{= model.oneOf.map(it => "value !== \"" + it + "\"").join(" && ") }}) {
    const oneOf = {{= quote(model.oneOf.join(", ")) }};
    throw _errorFn("validator.string.oneOf", { propertyPath, oneOf });
  }
{{ } }}

{{ if (model.validator.pattern !== undefined) { }}
  {{ const patternSrc = "/" + model.validator.pattern.source + "/" + model.validator.pattern.flags; }}
  if (!{{= patternSrc }}.test(value)) {
    throw _errorFn("validator.string.pattern", { propertyPath });
  }
{{ } }}

return value;
